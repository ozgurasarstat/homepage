---
title: Multi-arm Bandit
author: Ozgur Asar
date: '2020-01-29'
slug: multi-arm-bandit
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2020-01-29T14:48:00+03:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



<pre class="r"><code> suppressMessages(library(tidyverse))

 ## number of arms 
 k &lt;- 10
 
 ## true values of the arms
 q &lt;- rnorm(k, 0, 1); names(q) &lt;- 1:k
 
 ## rate of exploration
 eps &lt;- 0.1
 
 ## number of steps
 M &lt;- 1000
 
 ## number of replications
 nrep &lt;- 2000

 ## save the estimated values 
 Qsave &lt;- c()
 
 for(i in 1:nrep){
   
   ## simulate the bandits/rewards
   bandit &lt;- lapply(1:k, function(i) rnorm(1, q[i], 1)) %&gt;% unlist()
   
   ## save the number of selection and estimated values for ith replication
   N &lt;- Q &lt;- rep(0, k)
   
   for (ii in 1:M){
     
     if(runif(1) &lt; (1 - eps)){
       A &lt;- sample(which(Q == max(Q)), 1)
     }else{
       A &lt;- sample(1:k, 1)
     }
     
     R &lt;- bandit[A]
     
     N[A] &lt;- N[A] + 1
     Q[A] &lt;- Q[A] + (R - Q[A])/N[A]
     
   }
   
   Qsave &lt;- rbind(Qsave, Q)
   
 }
 
 ## averaged estimated values vs true values
 apply(Qsave, 1, which.max) %&gt;% table() %&gt;% &quot;/&quot;(nrep) %&gt;% round(2)</code></pre>
<pre><code>## .
##    1    2    3    4    5    6    7    8    9   10 
## 0.03 0.03 0.02 0.14 0.04 0.22 0.06 0.43 0.01 0.01</code></pre>
<pre class="r"><code> q %&gt;% round(2)</code></pre>
<pre><code>##     1     2     3     4     5     6     7     8     9    10 
## -0.43 -0.38 -0.54  0.42 -0.24  0.76 -0.05  1.26 -0.79 -0.81</code></pre>
